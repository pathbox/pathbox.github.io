---
layout: post
title: 最近工作总结(51)
date:  2023-03-01 21:00:00
categories: Work
image: /assets/images/post.jpg


---

### ​elasticsearch 小记

1. 有20个节点，将副本分片设置为19，这样每个节点都有20个分片(加上主分片)的数据，请求到该节点后，直接查询数据就可以返回了，省去了路由到别的节点带来的网络消耗。不过这样会增加磁盘空间的使用，毕竟数据多存了
2. 副本数默认是1，别忘了要进行调大，否则只会有2个节点有数据，其他节点没有数据，所有请求都转发到有数据的这两个节点上，承担了极大的请求压力
3. 建议有2个ES集群，实现物理隔离
4. 准备重启整个ES集群的脚本，可以快速重启集群
5. 使用别名方式切换所有是100%切换流量，可以使用Nacos，配置流量分配比例来实现灰度切换流量