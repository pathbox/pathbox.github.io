---
layout: post
title: 最近工作总结(24)
date:  2019-02-01 16:44:06
categories: Work
image: /assets/images/post.jpg
---

### TiDB 通过索引查询和直接扫描 Table 的区别

TiDB实现了全局索引，所以"索引和Table中的数据并不一定在一个数据分片上"，通过索引查询的时候，需要先扫描索引，得到对应的行ID，然后通过行ID去取数据，索引可能会涉及到两次网络请求，会有一定的行难呢过开销。

如果查询涉及到大量的行，那么扫描索引是并发镜像，只要第一批结果已经返回，就可以去取Table的数据，所以这里是一个并行+Pipeline的模式，虽然有两次访问的开销，但是延迟并不会很大。

### 文本协议和二进制协议

文本协议对人友好，二进制协议对机器友好

### 理解覆盖索引

>索引中的列已经满足了查询需求。比如 Table t 上面的列 c 有索引，查询是 select c from t where c > 10;，这个时候，只需要访问索引，就可以拿到所需要的全部数据。这种情况我们称之为覆盖索引(Covering Index)。所以如果很关注查询性能，可以将部分不需要过滤但是需要在查询结果中返回的列放入索引中，构造成组合索引，比如这个例子： select c1, c2 from t where c1 > 10;，要优化这个查询可以创建组合索引 Index c12 (c1, c2)。
